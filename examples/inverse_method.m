function inverse_method()

parameter = [4.94 0.173 120];  % [ a b  KLDF(min-1) ], initial estimates for optimization
isoType =   'langmuir';  % isotherm model
feedProf =  'pulse';  % feed profile, can be 'pulse' (e.g.: chromatografic peak) or 'step' (e.g.: breakthrough experiment)
L =         25;  % cm, column length
Di =        2;  % cm, column internal diameter
epsb =      0.79;  % column bulk porosity
Q =         20;  % mL/min, flow rate
Dax =       4.779E-3;  % cm2/min, axial dispersion coefficient
tpulse =    6/60;  % min, feed pulse duration. For a step injection set tpulse = tfinal
tfinal =    10;  % min, final time for calculation
opt.npz =   500;  % number of discretization points in z
opt.npt =   500;  % number of discretization points in t

%% Experimental data:
exp_Cfeed(1) = 10;  % g/L, feed concentration
exp_tc{1} =    [4.418626142	0.000747641
                4.605747543	0.001804057
                4.983635566	0.005156774
                5.354233145	0.001823815
                5.541354546	0.004101299
                5.739107845	0.015309029
                5.788014574	0.097135674
                5.796520093	0.162800721
                5.805025611	0.233689228
                5.807860784	0.04440052
                5.811641014	0.282855065
                5.813531129	0.45531189
                5.813531129	0.389645526
                5.813531129	0.323979162
                5.822036647	0.506052763
                5.82487182	0.544855176
                5.830542165	0.622460001
                5.830542165	0.688126365
                5.841882856	0.791598879
                5.845663087	0.728474567
                5.847553202	0.974667865
                5.847553202	0.876168318
                5.875904929	1.051937529
                5.907619888	1.212211036
                5.915597348	1.331345077
                5.919388055	1.265896529
                5.981211345	1.253835814
                6.068696675	1.228344569
                6.077202194	1.191182059
                6.09421323	1.151232387
                6.119729785	1.111288504
                6.153751858	1.070987966
                6.18777393	1.030261023
                6.221796003	0.991452903
                6.255818076	0.952857985
                6.289840149	0.914689472
                6.323862222	0.876094554
                6.357884295	0.837667152
                6.391906368	0.800450436
                6.42592844	0.764445928
                6.459950513	0.728750564
                6.493972586	0.693140481
                6.519489141	0.659912476
                6.57052225	0.624071009
                6.574167472	0.591430478
                6.625478082	0.561657385
                6.649014416	0.532745185
                6.720786405	0.479565961
                6.734017211	0.440171464
                6.795918483	0.399788302
                6.859709869	0.353007721
                6.913578151	0.311156418
                7.00005092	0.266461708
                7.068945617	0.222300358
                7.153477383	0.181417991
                7.242458189	0.14533108
                7.343106821	0.112431972
                7.406382722	0.089029499
                7.575590986	0.075716257
                7.769800318	0.056533491
                7.956921719	0.041444664
                8.14404312	0.030290392
                8.33541728	0.018060368
                8.518285921	0.010852113
                8.705407322	0.00768152
                8.892528723	0.00602445
                9.091426995	0.000190961
                9.276340232	0.002350178
                9.377343261	0.004298664];


%% RUN EXAMPLE ABOVE
addpath('../');  % add parent folder to path

fitModel_isotherm_KLDF(exp_tc, exp_Cfeed, isoType, feedProf, parameter, L, Di, epsb, Q, Dax, tpulse, tfinal, opt)
